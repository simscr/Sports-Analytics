---
title: "Soccer Data #3"
author: "CS"
date: "10/20/2021"
output: html_document
---


```{r setup, include = FALSE}
knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  fig.retina = 3,
  fig.path = here::here("exports", "soccer", "Plots", "/"),
  out.width = "100%"
)
pacman::p_load(pacman, tidyverse, janitor, here, rio, job, skimr, patchwork, viridis, paletteer, crsp)


theme_set(theme_bw(base_size = 15) + theme(legend.position = "bottom", legend.direction = "horizontal"))
```

```{r data, include = F}
p_load(StatsBombR, SBpitch, soccermatics, sportyR)

comps <- FreeCompetitions()

afc <- comps %>% 
  filter(competition_id == 2, season_id == 44) %>% 
  FreeMatches()

afc_raw <-  StatsBombFreeEvents(MatchesDF = afc) %>% 
  allclean() %>% 
  clean_names()

afc_shot <- afc_raw %>% 
  select(player_name, matches("shot")) %>% 
  filter(!is.na(shot_statsbomb_xg)) %>% 
  filter(shot_outcome_name != "Off T")


```

```{r shot-location-plot, include = TRUE}
geom_soccer(league = "Premier") + 
  ggplot(aes(shot_end_location_x, shot_end_location_y, color = shot_statsbomb_xg), data = afc_shot) + 
  geom_point(data = afc_shot)
```

```{r shot-location-plot-2, include = TRUE}
geom_soccer(league = "premier", touchline_length = 120, goal_line_length = 80) +
  geom_point(data = afc_shot, aes(shot_end_location_x-61, shot_end_location_y-40))
```

```{r shot-location-plot-3, include = T}
geom_soccer(league = "premier", 
            touchline_length = 120, goal_line_length = 80, 
            full_surf = F, rotate = T, grass_color = "black") +
  geom_point(data = afc_shot, 
             aes(y = -shot_end_location_x+60, x = shot_end_location_y-40, 
                 color = shot_statsbomb_xg), alpha = 0.3, size = 4) + 
  scale_color_paletteer_c("ggthemes::Temperature Diverging")

cani_color_league_features('premier')

```